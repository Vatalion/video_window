# MediaFile model for Story 3-2: Avatar & Media Upload System
# AC2: Virus scanning pipeline - persist scan status in media_files
# AC3: Image processing - stores S3 object under profile-media/{userId}/avatar.webp

class: MediaFile
table: media_files

fields:
  id: int?
  userId: int
  type: String
  originalFileName: String
  s3Key: String
  cdnUrl: String?
  mimeType: String
  fileSizeBytes: int
  # JSONB metadata stored as String (e.g., virus scan results, processing info)
  metadata: String?
  status: String
  isVirusScanned: bool
  createdAt: DateTime
  updatedAt: DateTime

indexes:
  media_user_id_idx:
    fields: userId
  media_status_idx:
    fields: status
  media_s3_key_idx:
    fields: s3Key

