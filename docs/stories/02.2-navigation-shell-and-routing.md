# Story 02.2: Build Navigation Shell and Route Registry

**Epic:** Epic 02 - Core Platform Services  
**Story ID:** 02.2  
**Priority:** P0 - Critical (Foundation)  
**Estimated Effort:** 8 story points  
**Status:** Approved  
**Created:** 2025-10-30

## User Story

**As a** user,  
**I want** consistent navigation scaffolding,  
**So that** I can move between feed, story, dashboard, and settings without dead ends.

## Acceptance Criteria

### AC1: Implement Navigator 2.0 with Typed Routes
**Given** the app needs robust navigation  
**When** Navigator 2.0 (or go_router) is configured  
**Then** typed routes exist for core destinations (feed, story, dashboard, settings, auth)

**Validation:**
- [ ] Route registry defines all core app routes with type safety
- [ ] Navigation uses declarative routing pattern
- [ ] Back button behavior works correctly on all platforms
- [ ] Deep linking supported with route parsing

### AC2: Deeplink Handling and Guarded Routes
**Given** users may access the app via external links  
**When** a deeplink is opened  
**Then** the app navigates to the correct screen with authentication guards applied

**Validation:**
- [ ] Deeplink patterns defined for stories, profiles, auctions
- [ ] Unauthenticated users redirect to auth flow
- [ ] Maker-only routes require maker role
- [ ] Invalid deeplinks show appropriate error screen

### AC3: Analytics Instrumentation
**Given** navigation needs to be tracked  
**When** a route changes  
**Then** analytics event fires with route name, source, and user context

**Validation:**
- [ ] Navigation events emit screen_view analytics
- [ ] Events include previous route for flow analysis
- [ ] User properties included (authenticated, role)
- [ ] Analytics documented in telemetry guide

## Dependencies
- Story 02.1 (Design tokens for navigation UI)
- Epic 01.1 (Repository structure)

## Testing Requirements
- [ ] Unit tests for route parsing and guards
- [ ] Widget tests for navigation flows
- [ ] Integration tests for deeplink handling
- [ ] Test coverage ≥85%

**Story Status:** Approved ✅  
**Approved By:** John (PM), Winston (Architect), Amelia (Dev Lead)
