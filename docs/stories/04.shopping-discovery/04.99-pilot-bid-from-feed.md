# 04.99 — Pilot: Buyer Bid from Feed

## Status
InProgress

## Priority
P0 (Pilot)

> Workflow: Draft → InProgress → Ready for Review → Done

## Summary
Enable buyers to propose a bid directly from a feed video featuring a handmade item, opening an auction if one does not exist, and show bids history on the item details page.

## Acceptance Criteria
- From any feed video with an item overlay, the user sees a "Propose bid" CTA when the item is bid-enabled.
- Tapping CTA opens a bid modal with amount entry, validation, and confirm/cancel.
- First valid bid creates/opens an auction; subsequent valid bids append to history.
- Success state shown after confirmation; auction state visible in feed (badge/timer).
- Item details page shows bids history ordered by time; updates within ≤2s (polling acceptable ≤10s in pilot).
- Error states: invalid amount, network errors; actionable copy.
- Telemetry events emitted for impression → CTA → submit → confirm; error events captured.
 - Min increment rule: system enforces bids ≥ current_highest + 1 USD.

## Telemetry
- feed_impression, cta_propose_bid_tap, bid_amount_entered, bid_submitted, bid_confirmed, auction_opened, bids_list_viewed, auction_state_changed, error_toast_shown.

## Notes
- Feature-flag the CTA and auction surfaces; enable only for pilot cohort.
- Region gating: Ukraine-only for pilot; surfaces and APIs enforce allowlist.

## Files/Areas Impacted
- Feed screen overlay
- Bid modal component
- Item details + bids history view
- Auction API integration
- Analytics wiring

## Definition of Done
- Feature-flagged surfaces shipped (bid CTA, auction indicators) with kill switch.
- UA-only region gating enforced in client and server; allowlist configured.
- Min bid increment (+1 USD) validated server-side and guarded client-side.
- Telemetry events implemented and verified against schema; dashboards show data.
- Accessibility: focus order and labels for CTA/modal; error messages announced.
- Error handling: network/timeouts; user-friendly retries; logged with context.
- Security: rate limiting; basic anti-abuse; no PII in analytics; secrets not committed.
- Code formatted, analyzed, and tests passing.

## Tasks / Subtasks
- Implement feed overlay CTA and auction badge/timer (flag-gated).
- Build bid modal with validation (+1 USD), confirm/cancel flows.
- Integrate Auction API (create/open, place bid, get auction); handle success/errors.
- Wire realtime updates (WS) with polling fallback on details page.
- Implement region/allowlist gating via feature flags and server checks.
- Emit analytics events per schema; add unit/widget tests for key paths.

## QA checklist
- CTA visibility respects feature flag and UA-only gating.
- Bid modal validation: amounts below highest+1 USD rejected; correct error copy.
- First bid opens auction; subsequent bids append; state visible in feed/details.
- Realtime updates ≤2s (or polling ≤10s) reflect new bids; no stale states.
- Kill switch hides CTA/indicators and blocks API calls within ≤5 minutes.
- Analytics funnel events fire with correct payloads; error rates <1%.

## Dev Agent Record
- Engineer: TBD
- Dates: TBD
- Notes: Initial pilot implementation; ensure flags and UA gating are wired before exposing CTA.

## QA Results
- Owner: TBD
- Test window: TBD
- Summary: Pending pilot QA. All acceptance criteria to be validated on UA cohort with flags enabled.